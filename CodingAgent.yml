app:
  description: ''
  icon: ğŸ¤–
  icon_background: '#FFEAD5'
  mode: workflow
  name: CodingAgent
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/openai:0.2.8@aae2be0913b8c6f0b80cff58e08d7a8b4c214569b41778413fcaea204561ff16
    version: null
kind: app
version: 0.5.0
workflow:
  conversation_variables: []
  environment_variables:
  - description: api_key
    id: 8bb0dd50-b7f4-4420-9b17-08173e54adaa
    name: API_KEY
    selector:
    - env
    - API_KEY
    value: ''
    value_type: secret
  features:
    file_upload:
      allowed_file_extensions:
      - .JPG
      - .JPEG
      - .PNG
      - .GIF
      - .WEBP
      - .SVG
      allowed_file_types:
      - image
      allowed_file_upload_methods:
      - local_file
      - remote_url
      enabled: false
      fileUploadConfig:
        audio_file_size_limit: 50
        batch_count_limit: 5
        file_size_limit: 15
        image_file_batch_limit: 10
        image_file_size_limit: 10
        single_chunk_attachment_limit: 10
        video_file_size_limit: 100
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: ''
    retriever_resource:
      enabled: true
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: start
        targetType: llm
      id: 1766665854400-source-1766666534467-target
      selected: false
      source: '1766665854400'
      sourceHandle: source
      target: '1766666534467'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: llm
        targetType: llm
      id: 1766666534467-source-1766667562386-target
      selected: false
      source: '1766666534467'
      sourceHandle: source
      target: '1766667562386'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: llm
      id: 1766666534467-source-1766666714696-target
      selected: false
      source: '1766666534467'
      sourceHandle: source
      target: '1766666714696'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: loop
      id: 1766667562386-source-1766681217998-target
      selected: false
      source: '1766667562386'
      sourceHandle: source
      target: '1766681217998'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: true
        loop_id: '1766681217998'
        sourceType: if-else
        targetType: loop-end
      id: 17666823941251-false-1766682485472-target
      selected: false
      source: '17666823941251'
      sourceHandle: 'false'
      target: '1766682485472'
      targetHandle: target
      type: custom
      zIndex: 1002
    - data:
        isInIteration: false
        isInLoop: true
        loop_id: '1766681217998'
        sourceType: if-else
        targetType: llm
      id: 17666823941251-true-1766682500741-target
      selected: false
      source: '17666823941251'
      sourceHandle: 'true'
      target: '1766682500741'
      targetHandle: target
      type: custom
      zIndex: 1002
    - data:
        isInLoop: false
        sourceType: loop
        targetType: end
      id: 1766681217998-source-1766680328187-target
      selected: false
      source: '1766681217998'
      sourceHandle: source
      target: '1766680328187'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: true
        loop_id: '1766681217998'
        sourceType: http-request
        targetType: code
      id: 1766769039651-source-1766769356726-target
      selected: false
      source: '1766769039651'
      sourceHandle: source
      target: '1766769356726'
      targetHandle: target
      type: custom
      zIndex: 1002
    - data:
        isInIteration: false
        isInLoop: true
        loop_id: '1766681217998'
        sourceType: code
        targetType: if-else
      id: 1766769356726-source-17666823941251-target
      selected: false
      source: '1766769356726'
      sourceHandle: source
      target: '17666823941251'
      targetHandle: target
      type: custom
      zIndex: 1002
    - data:
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 1766666714696-source-17667737781900-target
      source: '1766666714696'
      sourceHandle: source
      target: '17667737781900'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: loop
      id: 17667737781900-source-1766681217998-target
      selected: false
      source: '17667737781900'
      sourceHandle: source
      target: '1766681217998'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: true
        loop_id: '1766681217998'
        sourceType: llm
        targetType: code
      id: 1766682500741-source-1766771232701-target
      source: '1766682500741'
      sourceHandle: source
      target: '1766771232701'
      targetHandle: target
      type: custom
      zIndex: 1002
    - data:
        isInIteration: false
        isInLoop: true
        loop_id: '1766681217998'
        sourceType: code
        targetType: assigner
      id: 1766771232701-source-1766682647945-target
      source: '1766771232701'
      sourceHandle: source
      target: '1766682647945'
      targetHandle: target
      type: custom
      zIndex: 1002
    - data:
        isInIteration: false
        isInLoop: true
        loop_id: '1766681217998'
        sourceType: loop-start
        targetType: code
      id: 1766681217998start-source-1766774144559-target
      source: 1766681217998start
      sourceHandle: source
      target: '1766774144559'
      targetHandle: target
      type: custom
      zIndex: 1002
    - data:
        isInIteration: false
        isInLoop: true
        loop_id: '1766681217998'
        sourceType: code
        targetType: http-request
      id: 1766774144559-source-1766769039651-target
      source: '1766774144559'
      sourceHandle: source
      target: '1766769039651'
      targetHandle: target
      type: custom
      zIndex: 1002
    nodes:
    - data:
        selected: false
        title: ç”¨æˆ·è¾“å…¥
        type: start
        variables:
        - default: æˆ‘è¦ä¸€ä¸ªè²ªåƒè›‡æ¸¸æˆ
          hint: ''
          label: project_requirement
          max_length: 256
          options: []
          placeholder: ''
          required: true
          type: text-input
          variable: project_requirement
      height: 108
      id: '1766665854400'
      position:
        x: 0
        y: 272
      positionAbsolute:
        x: 0
        y: 272
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        context:
          enabled: true
          variable_selector:
          - '1766665854400'
          - project_requirement
        desc: generate user story
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: gpt-3.5-turbo
          provider: langgenius/openai/openai
        prompt_template:
        - id: 2cdd8318-3c97-4b5a-b3e3-cc60043b603f
          role: system
          text: 'ä»¥ä¸‹æ˜¯ç”¨æˆ·çš„åŸå§‹éœ€æ±‚ï¼š

            {{#1766665854400.project_requirement#}}

            ä½ çš„ä»»åŠ¡æ˜¯å°†è¯¥éœ€æ±‚æ‹†è§£ä¸ºå·¥ç¨‹å¯å®ç°çš„è§„èŒƒè¯´æ˜ï¼Œä¾›åç»­ Coder ä¸ Testcase Agent ä½¿ç”¨ã€‚

            è¯·ä¸¥æ ¼æŒ‰ä»¥ä¸‹ç»“æ„è¾“å‡ºï¼ˆå¿…é¡»åŒ…å«æ‰€æœ‰å­—æ®µï¼‰ï¼š

            [PROJECT_SUMMARY]

            ç”¨1å¥è¯æ¦‚æ‹¬è¿™ä¸ªé¡¹ç›®çš„ç›®æ ‡ã€‚

            [USER_STORIES]

            åˆ—å‡º 3â€“5 æ¡ User Storyã€‚æ¯æ¡å¿…é¡»åŒ…å«ï¼š

            - roleï¼šç”¨æˆ·èº«ä»½

            - behaviorï¼šç”¨æˆ·å¯ä»¥åšä»€ä¹ˆ

            - goalï¼šè¿™æ ·åšçš„ç›®çš„

            [ACCEPTANCE_CRITERIA]

            é’ˆå¯¹æ¯æ¡ User Storyï¼Œåˆ—å‡ºæ˜ç¡®ã€å¯éªŒè¯çš„éªŒæ”¶æ ‡å‡†ã€‚

            [NON_GOALS]

            æ˜ç¡®æŒ‡å‡ºæœ¬é¡¹ç›®ä¸éœ€è¦å®ç°çš„åŠŸèƒ½ï¼Œé¿å…è¿‡åº¦è®¾è®¡ã€‚

            è¦æ±‚ï¼š

            - è¾“å‡ºå¿…é¡»æ¸…æ™°ã€ç»“æ„åŒ–

            - ä¸è¦è¾“å‡ºä»»ä½•ä»£ç 

            - ä¸è¦è§£é‡Šä½ çš„æ€è€ƒè¿‡ç¨‹'
        selected: false
        structured_output_enabled: false
        title: user story agent
        type: llm
        vision:
          enabled: false
      height: 115
      id: '1766666534467'
      position:
        x: 342
        y: 268
      positionAbsolute:
        x: 342
        y: 268
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
    - data:
        context:
          enabled: true
          variable_selector:
          - '1766666534467'
          - text
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: gpt-3.5-turbo
          provider: langgenius/openai/openai
        prompt_template:
        - id: 23f3f79a-727f-4a7d-a66c-aa4218c082dd
          role: system
          text: 'ä½ æ˜¯ Coder Agentã€‚è¯·æ ¹æ®ä»¥ä¸‹user story{{#1766666534467.text#}}ç¼–å†™å®Œæ•´çš„ã€å¯è¿è¡Œçš„ä»£ç ã€‚

            ä¸¥æ ¼éµå®ˆä»¥ä¸‹è¦æ±‚ï¼š

            1. åªä½¿ç”¨ Python æ ‡å‡†åº“ï¼ˆé™¤éè§„èŒƒä¸­æ˜ç¡®å…è®¸ç¬¬ä¸‰æ–¹åº“ï¼‰

            2. å¿…é¡»æ˜¯å•æ–‡ä»¶ç¨‹åº

            3. å¿…é¡»åŒ…å«æ¸…æ™°çš„ç¨‹åºå…¥å£ï¼ˆif __name__ == "__main__":ï¼‰

            4. ç¨‹åºå¯ä»¥ç›´æ¥é€šè¿‡ `python main.py`ï¼ˆæˆ–ç­‰ä»·æ–¹å¼ï¼‰è¿è¡Œ

            5. ä¸è¦å®ç°è§„èŒƒä¸­æ˜ç¡®æ ‡æ³¨ä¸º NON_GOALS çš„å†…å®¹

            è¾“å‡ºè¦æ±‚ï¼š

            - åªè¾“å‡ºå®Œæ•´ä»£ç 

            - ä¸è¦åŒ…å«ä»»ä½•è§£é‡Šã€æ³¨é‡Šè¯´æ˜æˆ– Markdown æ ‡è®°

            '
        selected: true
        title: initial coder
        type: llm
        vision:
          enabled: false
      height: 87
      id: '1766666714696'
      position:
        x: 703
        y: 301
      positionAbsolute:
        x: 703
        y: 301
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
    - data:
        context:
          enabled: true
          variable_selector:
          - '1766666534467'
          - text
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: gpt-3.5-turbo
          provider: langgenius/openai/openai
        prompt_template:
        - id: f17d1b2b-04a4-4b88-867a-0085ea8727e9
          role: system
          text: '{{#1766666534467.text#}}ä½ çš„ä»»åŠ¡æ˜¯ä¸ºè¯¥é¡¹ç›®è®¾è®¡æµ‹è¯•è¦æ±‚ï¼Œç”¨äºéªŒè¯ä»£ç æ˜¯å¦ç¬¦åˆè§„èŒƒã€‚

            è¯·ä¸¥æ ¼æŒ‰ä»¥ä¸‹ç»“æ„è¾“å‡ºï¼š

            ã€TEST_STRATEGYã€‘

            ç®€è¦è¯´æ˜æµ‹è¯•è¦†ç›–çš„æ ¸å¿ƒæ€è·¯ï¼ˆåŠŸèƒ½ã€è¾¹ç•Œã€å¼‚å¸¸ç­‰ï¼‰ã€‚

            ã€TEST_CASESã€‘

            åˆ—å‡º 5â€“8 æ¡æµ‹è¯•ç”¨ä¾‹ã€‚æ¯æ¡å¿…é¡»åŒ…å«ï¼š

            - idï¼šæµ‹è¯•ç¼–å·

            - descriptionï¼šæµ‹è¯•åœºæ™¯æè¿°

            - expected_resultï¼šæœŸæœ›ç»“æœ

            ã€PASS_CRITERIAã€‘

            æ˜ç¡®è¯´æ˜åœ¨ä»€ä¹ˆæƒ…å†µä¸‹å¯ä»¥åˆ¤å®šâ€œæ•´ä½“æµ‹è¯•é€šè¿‡â€ã€‚

            è¦æ±‚ï¼š

            - ä¸è¦ç¼–å†™ä»»ä½•æµ‹è¯•ä»£ç 

            - åªè¾“å‡ºæµ‹è¯•é€»è¾‘ä¸æœŸæœ›

            - è¾“å‡ºå†…å®¹å¿…é¡»æ¸…æ™°ã€å¯ç”¨äºäººå·¥æˆ–è‡ªåŠ¨åˆ¤å®š'
        selected: false
        title: testcase agent
        type: llm
        vision:
          enabled: false
      height: 87
      id: '1766667562386'
      position:
        x: 813
        y: 152
      positionAbsolute:
        x: 813
        y: 152
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
    - data:
        outputs:
        - value_selector:
          - '1766681217998'
          - current_code
          value_type: string
          variable: output
        selected: false
        title: è¾“å‡º
        type: end
      height: 87
      id: '1766680328187'
      position:
        x: 3918
        y: 215
      positionAbsolute:
        x: 3918
        y: 215
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
    - data:
        break_conditions: []
        error_handle_mode: terminated
        height: 518
        logical_operator: and
        loop_count: 3
        loop_variables:
        - id: 830d1fc9-96bc-4ba1-b05b-9f2ab4e2cae9
          label: current_code
          value:
          - '17667737781900'
          - current_code
          value_type: variable
          var_type: string
        selected: false
        start_node_id: 1766681217998start
        title: å¾ªç¯
        type: loop
        width: 2433
      height: 518
      id: '1766681217998'
      position:
        x: 1385
        y: 0
      positionAbsolute:
        x: 1385
        y: 0
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 2433
      zIndex: 1
    - data:
        desc: ''
        isInLoop: true
        selected: false
        title: ''
        type: loop-start
      draggable: false
      height: 48
      id: 1766681217998start
      parentId: '1766681217998'
      position:
        x: 60
        y: 173
      positionAbsolute:
        x: 1445
        y: 173
      selectable: false
      sourcePosition: right
      targetPosition: left
      type: custom-loop-start
      width: 44
      zIndex: 1002
    - data:
        author: Zhuang Keju
        desc: ''
        height: 88
        selected: false
        showAuthor: true
        text: ''
        theme: blue
        title: ''
        type: ''
        width: 240
      height: 88
      id: '1766681921022'
      position:
        x: 878.4648134797859
        y: 615.3529237451298
      positionAbsolute:
        x: 878.4648134797859
        y: 615.3529237451298
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom-note
      width: 240
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: is
            id: 8fe66ca4-5c80-4bf3-a797-56faa5c10819
            value: false
            varType: boolean
            variable_selector:
            - '1766769356726'
            - is_pass
          id: 'true'
          logical_operator: and
        isInLoop: true
        selected: false
        title: æ¡ä»¶åˆ†æ”¯ (1)
        type: if-else
      height: 123
      id: '17666823941251'
      parentId: '1766681217998'
      position:
        x: 1147
        y: 135
      positionAbsolute:
        x: 2532
        y: 135
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
    - data:
        isInIteration: false
        isInLoop: true
        loop_id: '1766681217998'
        selected: false
        title: é€€å‡ºå¾ªç¯
        type: loop-end
      height: 53
      id: '1766682485472'
      parentId: '1766681217998'
      position:
        x: 1488
        y: 60
      positionAbsolute:
        x: 2873
        y: 60
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom-simple
      width: 244
      zIndex: 1002
    - data:
        context:
          enabled: false
          variable_selector: []
        isInIteration: false
        isInLoop: true
        loop_id: '1766681217998'
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: gpt-3.5-turbo
          provider: langgenius/openai/openai
        prompt_template:
        - id: 13d78372-655a-4b59-9419-8b54ed53876c
          role: system
          text: 'å½“å‰ä»£ç æœªé€šè¿‡æµ‹è¯•ï¼Œæµ‹è¯•åé¦ˆå¦‚ä¸‹ï¼š

            {{#1766769356726.error_log#}}

            å½“å‰ä»£ç å¦‚ä¸‹ï¼š

            {{#1766681217998.current_code#}}

            ä½ çš„ä»»åŠ¡æ˜¯æ ¹æ®æµ‹è¯•åé¦ˆä¿®å¤ä»£ç ã€‚

            ä¿®å¤è¦æ±‚ï¼š

            1. åªè¿›è¡Œä¸ºä¿®å¤å¤±è´¥åŸå› æ‰€å¿…éœ€çš„æœ€å°ä¿®æ”¹

            2. ä¸è¦é‡æ„æ•´ä½“æ¶æ„

            3. ä¿æŒç¨‹åºçš„è¿è¡Œæ–¹å¼ä¸å…¥å£ä¸å˜

            4. ä¿®å¤ååº”æ»¡è¶³æ‰€æœ‰æµ‹è¯•è¦æ±‚ä¸äº§å“è§„èŒƒ

            è¾“å‡ºè¦æ±‚ï¼š

            - åªè¾“å‡ºã€ä¿®å¤åçš„å®Œæ•´ä»£ç ã€‘

            - ä¸è¦è¾“å‡ºä»»ä½•è§£é‡Šã€è¯´æ˜æˆ– Markdown'
        selected: false
        title: Debugging Agent
        type: llm
        vision:
          enabled: false
      height: 87
      id: '1766682500741'
      parentId: '1766681217998'
      position:
        x: 1488
        y: 173
      positionAbsolute:
        x: 2873
        y: 173
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
      zIndex: 1002
    - data:
        isInIteration: false
        isInLoop: true
        items:
        - input_type: variable
          operation: over-write
          value:
          - '1766771232701'
          - current_code
          variable_selector:
          - '1766681217998'
          - current_code
          write_mode: over-write
        loop_id: '1766681217998'
        selected: false
        title: å˜é‡èµ‹å€¼
        type: assigner
        version: '2'
      height: 83
      id: '1766682647945'
      parentId: '1766681217998'
      position:
        x: 2130
        y: 175
      positionAbsolute:
        x: 3515
        y: 175
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
      zIndex: 1002
    - data:
        authorization:
          config: null
          type: no-auth
        body:
          data:
          - id: key-value-325
            key: ''
            type: text
            value: '{{#1766774144559.payload#}}'
          type: json
        headers: Authorization:Bearer {{#env.API_KEY#}}
        isInIteration: false
        isInLoop: true
        loop_id: '1766681217998'
        method: post
        params: ''
        retry_config:
          max_retries: 3
          retry_enabled: true
          retry_interval: 100
        selected: false
        ssl_verify: true
        timeout:
          max_connect_timeout: 0
          max_read_timeout: 0
          max_write_timeout: 0
        title: Code Exec API
        type: http-request
        url: https://vercel-code-runner.vercel.app/api/exec
        variables: []
      height: 136
      id: '1766769039651'
      parentId: '1766681217998'
      position:
        x: 505
        y: 129
      positionAbsolute:
        x: 1890
        y: 129
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
      zIndex: 1002
    - data:
        code: "def main(exec_output: str) -> dict:\n    \"\"\"\n    è¾“å…¥: Vercel è¿”å›çš„\
          \ json å­—ç¬¦ä¸²\n    è¾“å‡º: ç»“æ„åŒ–çš„åˆ¤æ–­ç»“æœ\n    \"\"\"\n\n    # 1. é»˜è®¤å¤±è´¥\n    is_pass =\
          \ False\n    \n    # 2. æ ¸å¿ƒåˆ¤æ–­é€»è¾‘ (æ ¹æ® unittest çš„æ ‡å‡†è¾“å‡º)\n    # å¦‚æœé€šè¿‡ï¼Œé€šå¸¸åŒ…å« \"OK\"\
          \n    # å¦‚æœå¤±è´¥ï¼Œé€šå¸¸åŒ…å« \"FAILED\" æˆ– \"Error\"\n    if \"OK\" in exec_output and\
          \ \"FAILED\" not in exec_output:\n        is_pass = True\n        \n   \
          \ return {\n        \"is_pass\": is_pass,\n        # æŠŠåŸå§‹æŠ¥é”™æˆªå–å‡ºæ¥ï¼Œå–‚ç»™åé¢çš„ Debugger\
          \ ç”¨\n        \"error_log\": exec_output \n    }"
        code_language: python3
        isInIteration: false
        isInLoop: true
        loop_id: '1766681217998'
        outputs:
          error_log:
            children: null
            type: string
          is_pass:
            children: null
            type: boolean
        selected: false
        title: QA Judge
        type: code
        variables:
        - value_selector:
          - '1766769039651'
          - body
          value_type: string
          variable: exec_output
      height: 51
      id: '1766769356726'
      parentId: '1766681217998'
      position:
        x: 826
        y: 171
      positionAbsolute:
        x: 2211
        y: 171
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
      zIndex: 1002
    - data:
        code: "import re\nimport json\n\ndef main(llm_output: str) -> dict:\n    code\
          \ = llm_output.strip()\n    \n    # ----------------------------------------\n\
          \    # 1. å°è¯•å‰¥ç¦» Markdown (```python ... ```)\n    # ----------------------------------------\n\
          \    # è¿™é‡Œçš„æ­£åˆ™è§£é‡Šï¼š\n    # ```             -> åŒ¹é…å¼€å¤´åå¼•å·\n    # (?:python|json)?\
          \ -> å¯é€‰çš„è¯­è¨€æ ‡è®° (python æˆ– json)ï¼Œ?:è¡¨ç¤ºä¸æ•è·\n    # \\s* -> åƒæ‰æ¢è¡Œç¬¦\n    # (.*?) \
          \          -> æ ¸å¿ƒæ•è·ç»„ï¼šæå–ä¸­é—´çš„æ‰€æœ‰ä»£ç  (éè´ªå©ª)\n    # ```             -> åŒ¹é…ç»“å°¾åå¼•å·\n\
          \    # re.DOTALL       -> è®©ç‚¹å·(.)å¯ä»¥åŒ¹é…æ¢è¡Œç¬¦ï¼Œè¿™å¾ˆå…³é”®ï¼\n    pattern = r\"```(?:python|json)?\\\
          s*(.*?)```\"\n    match = re.search(pattern, code, re.DOTALL | re.IGNORECASE)\n\
          \    \n    if match:\n        code = match.group(1).strip()\n    \n    #\
          \ ----------------------------------------\n    # 2. å¦‚æœè¿™æœ¬èº«æ˜¯ä¸€æ®µ JSON å­—ç¬¦ä¸²ï¼ˆæœ‰æ—¶å€™\
          \ LLM ä¼šæŠŠ JSON åŒ…åœ¨ Markdown é‡Œï¼‰\n    #    æˆ‘ä»¬éœ€è¦æŠŠå®ƒè§£å¼€ï¼Œåªæ‹¿é‡Œé¢çš„ code å­—æ®µ\n    # ----------------------------------------\n\
          \n    # æˆ‘è§‰å¾—è¿™ä¸€æ®µå¯ä»¥æ³¨é‡Šæ‰\n    try:\n        # å°è¯•è§£æ JSON\n        data = json.loads(code)\n\
          \        if isinstance(data, dict) and \"code\" in data:\n            code\
          \ = data[\"code\"]\n    except json.JSONDecodeError:\n        # å¦‚æœä¸æ˜¯ JSONï¼Œé‚£è¯´æ˜å‰¥ç¦»\
          \ Markdown åå°±æ˜¯çº¯ Python ä»£ç äº†ï¼Œä¸åšå¤„ç†\n        pass\n\n    # http_body_struct\
          \ = {\n    #     \"code\": code\n    # }\n    # pythonæ‰“åŒ…jsonï¼Œä¸ç”¨difyæ‰“åŒ…\n\
          \    return {\n        # \"payload\": json.dumps(http_body_struct) ,\n \
          \       # è¾“å‡ºå˜æˆäº†å­—ç¬¦ä¸²ï¼š{\"code\": \"def ...\"}\n        \"current_code\": code\n\
          \n    }"
        code_language: python3
        isInIteration: false
        isInLoop: true
        loop_id: '1766681217998'
        outputs:
          current_code:
            children: null
            type: string
        selected: false
        title: Code Cleaner
        type: code
        variables:
        - value_selector:
          - '1766682500741'
          - text
          value_type: string
          variable: llm_output
      height: 51
      id: '1766771232701'
      parentId: '1766681217998'
      position:
        x: 1809
        y: 191
      positionAbsolute:
        x: 3194
        y: 191
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
      zIndex: 1002
    - data:
        code: "import re\nimport json\n\ndef main(llm_output: str) -> dict:\n    code\
          \ = llm_output.strip()\n    \n    # ----------------------------------------\n\
          \    # 1. å°è¯•å‰¥ç¦» Markdown (```python ... ```)\n    # ----------------------------------------\n\
          \    # è¿™é‡Œçš„æ­£åˆ™è§£é‡Šï¼š\n    # ```             -> åŒ¹é…å¼€å¤´åå¼•å·\n    # (?:python|json)?\
          \ -> å¯é€‰çš„è¯­è¨€æ ‡è®° (python æˆ– json)ï¼Œ?:è¡¨ç¤ºä¸æ•è·\n    # \\s* -> åƒæ‰æ¢è¡Œç¬¦\n    # (.*?) \
          \          -> æ ¸å¿ƒæ•è·ç»„ï¼šæå–ä¸­é—´çš„æ‰€æœ‰ä»£ç  (éè´ªå©ª)\n    # ```             -> åŒ¹é…ç»“å°¾åå¼•å·\n\
          \    # re.DOTALL       -> è®©ç‚¹å·(.)å¯ä»¥åŒ¹é…æ¢è¡Œç¬¦ï¼Œè¿™å¾ˆå…³é”®ï¼\n    pattern = r\"```(?:python|json)?\\\
          s*(.*?)```\"\n    match = re.search(pattern, code, re.DOTALL | re.IGNORECASE)\n\
          \    \n    if match:\n        code = match.group(1).strip()\n    \n    #\
          \ ----------------------------------------\n    # 2. å¦‚æœè¿™æœ¬èº«æ˜¯ä¸€æ®µ JSON å­—ç¬¦ä¸²ï¼ˆæœ‰æ—¶å€™\
          \ LLM ä¼šæŠŠ JSON åŒ…åœ¨ Markdown é‡Œï¼‰\n    #    æˆ‘ä»¬éœ€è¦æŠŠå®ƒè§£å¼€ï¼Œåªæ‹¿é‡Œé¢çš„ code å­—æ®µ\n    # ----------------------------------------\n\
          \n    # æˆ‘è§‰å¾—è¿™ä¸€æ®µå¯ä»¥æ³¨é‡Šæ‰\n    try:\n        # å°è¯•è§£æ JSON\n        data = json.loads(code)\n\
          \        if isinstance(data, dict) and \"code\" in data:\n            code\
          \ = data[\"code\"]\n    except json.JSONDecodeError:\n        # å¦‚æœä¸æ˜¯ JSONï¼Œé‚£è¯´æ˜å‰¥ç¦»\
          \ Markdown åå°±æ˜¯çº¯ Python ä»£ç äº†ï¼Œä¸åšå¤„ç†\n        pass\n\n    http_body_struct =\
          \ {\n        \"code\": code\n    }\n    # pythonæ‰“åŒ…jsonï¼Œä¸ç”¨difyæ‰“åŒ…\n    return\
          \ {\n        \"current_code\": code\n\n    }"
        code_language: python3
        isInIteration: false
        isInLoop: true
        loop_id: '1766681217998'
        outputs:
          current_code:
            children: null
            type: string
        selected: false
        title: Code Cleaner (1)
        type: code
        variables:
        - value_selector:
          - '1766666714696'
          - text
          value_type: string
          variable: llm_output
      height: 51
      id: '17667737781900'
      position:
        x: 1044
        y: 319
      positionAbsolute:
        x: 1044
        y: 319
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
      zIndex: 1002
    - data:
        code: "import json\n\ndef main(current_code: str) -> dict:\n    # æ„é€  Payload\
          \ å­—å…¸\n    # è¿™é‡Œå¯ä»¥æ‰©å±•ï¼šå¦‚æœä½ ä»¥åæƒ³ä¼  test_casesï¼Œä¹Ÿå¯ä»¥åŠ åœ¨è¿™é‡Œ\n    payload_dict = {\n  \
          \      \"code\": current_code\n    }\n    \n    return {\n        \"payload\"\
          : json.dumps(payload_dict)\n    }"
        code_language: python3
        isInIteration: false
        isInLoop: true
        loop_id: '1766681217998'
        outputs:
          payload:
            children: null
            type: string
        selected: false
        title: payload parser
        type: code
        variables:
        - value_selector:
          - '1766681217998'
          - current_code
          value_type: string
          variable: current_code
      height: 51
      id: '1766774144559'
      parentId: '1766681217998'
      position:
        x: 184
        y: 171
      positionAbsolute:
        x: 1569
        y: 171
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
      zIndex: 1002
    viewport:
      x: -82.5498169812106
      y: 74.72839509467616
      zoom: 0.4824949326945132
  rag_pipeline_variables: []
